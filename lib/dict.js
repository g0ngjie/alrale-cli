#!/usr/bin/env node
const superagent=require("superagent"),{GetTable:GetTable}=require("./utils"),ora=require("ora");function queryByYoudao(s){return new Promise(a=>{const r=ora().start();r.color="cyan",superagent.get("http://fanyi.youdao.com/openapi.do?keyfrom=toaijf&key=868480929&type=data&doctype=json&version=1.1").query({q:s}).end((e,o)=>{r.stop(),e&&a({ok:!1,msg:"对不起,再试一次"});o=JSON.parse(o.text);let t={};o.basic?t[s]=o.basic.explains:o.translation?t[s]=o.translation:a({ok:!1,msg:"查询异常"}),a({ok:!0,msg:t})})})}exports.Query=async function(e){var{ok:o,msg:e}=await queryByYoudao(e);return o?{ok:o,msg:GetTable([e])}:{ok:o,msg:e}};