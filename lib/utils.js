#!/usr/bin/env node
const inquirer=require("inquirer"),https=require("https"),http=require("http"),{spawn:spawn}=require("child_process"),Table=require("cli-table2"),os=require("os"),ora=require("ora"),download=require("download-git-repo"),path=require("path"),rimraf=require("rimraf"),NotNegativeFloatReg=/^\d+(\.\d+)?$/,NotPositiveFloatReg=/^((-\d+(\.\d+)?)|(0+(\.0+)?))$/;exports.IsNumber=function(e){return NotNegativeFloatReg.test(e)||NotPositiveFloatReg.test(e)},exports.PrefixZero=function(e,t=2){return exports.IsNumber(e)?+e<10**(t-1)?(Array(t).join("0")+e).slice(-t):e+"":""},exports.ClearQuotes=function(e){return e.replace(/\"|\'/g,"")},exports.Inquirer=function(e=[]){return new Promise(t=>{inquirer.prompt(e).then(e=>{t({ok:!0,data:e})}).catch(e=>{e.isTtyError?t({ok:!1,msg:"不能在当前环境下呈现"}):t({ok:!1,msg:e+""})})})},exports.HttpsGet=function(e){return new Promise(t=>{https.get(e,function(e){200===e.statusCode?e.on("data",function(e){t({ok:!0,data:e})}):t({ok:!1,msg:e.statusMessage})}).on("error",function(e){t({ok:!1,msg:e.message})})})},exports.HttpGet=function(e){return new Promise(t=>{http.get(e,function(e){200===e.statusCode?e.on("data",function(e){t({ok:!0,data:e})}):t({ok:!1,msg:e.statusMessage})}).on("error",function(e){t({ok:!1,msg:e.message})})})},exports.GetTable=function(t,e){const o=new Table({head:e});for(let e=0;e<t.length;e++){var r=t[e];o.push(r)}return o.toString()},exports.GetPlatform=function(){var e={aix:"IBM AIX",android:"Android",darwin:"Apple",freebsd:"FreeBSD",linux:"Linux",openbsd:"OpenBSD",sunos:"SunOS",win32:"Windows"}[os.platform()]||"unknown";return{isWindow:"Windows"===e,isApple:"Apple"===e,isLinux:"Linux"===e,infos:e}},exports.Shell=function(r,n,s){return new Promise(t=>{const o=ora().start();o.color="cyan";const e=spawn(r,n,s);e.stdout.on("data",e=>t({ok:!0,data:e.toString()})),e.stdout.on("end",()=>o.stop()),e.stdout.on("error",e=>{o.stop(),t({ok:!1,msg:e.message})})})},exports.DownloadTemplate=function(e,r,t=!1){let o;return o=t?r:path.join(process.cwd(),r),rimraf.sync(o,{}),new Promise((t,o)=>{download(e,r,{clone:!0},e=>{e?o(e):t(r)})})};