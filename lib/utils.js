#!/usr/bin/env node
const inquirer=require("inquirer"),https=require("https"),http=require("http"),{spawn:spawn}=require("child_process"),Table=require("cli-table2"),os=require("os"),ora=require("ora"),NotNegativeFloatReg=/^\d+(\.\d+)?$/,NotPositiveFloatReg=/^((-\d+(\.\d+)?)|(0+(\.0+)?))$/;exports.IsNumber=function(t){return NotNegativeFloatReg.test(t)||NotPositiveFloatReg.test(t)},exports.PrefixZero=function(t,e=2){return exports.IsNumber(t)?+t<10**(e-1)?(Array(e).join("0")+t).slice(-e):t+"":""},exports.ClearQuotes=function(t){return t.replace(/\"|\'/g,"")},exports.Inquirer=function(t=[]){return new Promise(e=>{inquirer.prompt(t).then(t=>{e({ok:!0,data:t})}).catch(t=>{t.isTtyError?e({ok:!1,msg:"不能在当前环境下呈现"}):e({ok:!1,msg:t+""})})})},exports.HttpsGet=function(t){return new Promise(e=>{https.get(t,function(t){200===t.statusCode?t.on("data",function(t){e({ok:!0,data:t})}):e({ok:!1,msg:t.statusMessage})}).on("error",function(t){e({ok:!1,msg:t.message})})})},exports.HttpGet=function(t){return new Promise(e=>{http.get(t,function(t){200===t.statusCode?t.on("data",function(t){e({ok:!0,data:t})}):e({ok:!1,msg:t.statusMessage})}).on("error",function(t){e({ok:!1,msg:t.message})})})},exports.GetTable=function(e,t){const o=new Table({head:t});for(let t=0;t<e.length;t++){var r=e[t];o.push(r)}return o.toString()},exports.GetPlatform=function(){var t={aix:"IBM AIX",android:"Android",darwin:"Apple",freebsd:"FreeBSD",linux:"Linux",openbsd:"OpenBSD",sunos:"SunOS",win32:"Windows"}[os.platform()]||"unknown";return{isWindow:"Windows"===t,isApple:"Apple"===t,isLinux:"Linux"===t,infos:t}},exports.Shell=function(r,n,s){return new Promise(e=>{const o=ora().start();o.color="cyan";const t=spawn(r,n,s);t.stdout.on("data",t=>e({ok:!0,data:t.toString()})),t.stdout.on("end",()=>o.stop()),t.stdout.on("error",t=>{o.stop(),e({ok:!1,msg:t.message})})})};